// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Estado {
  ACTIVO
  INACTIVO
}

model Roles {
  id_rol   Int        @id @default(autoincrement())
  nombre   String
  Estado   Estado     @default(ACTIVO)
  Usuarios Usuarios[]
}
model Sucursales {
  id_sucursal    Int              @id @default(autoincrement())
  nombre         String
  estado         Estado           @default(ACTIVO)
  Usuarios       Usuarios[] 
}


model Usuarios {
  id             Int      @id @default(autoincrement())
  usuario        String
  password       String
  nombres        String
  apellidos      String
  dui            String?
  foto           String?  @unique
  estado         Estado   @default(ACTIVO)
  fecha_creacion DateTime @default(now()) @db.Timestamp()

  id_rol Int
  Roles  Roles @relation(fields: [id_rol], references: [id_rol], onDelete: NoAction, onUpdate: NoAction, map: "fk_usuario_rol")

  id_sucursal Int
  Sucursales  Sucursales @relation(fields: [id_sucursal], references: [id_sucursal], onDelete: NoAction, onUpdate: NoAction, map: "fk_usuario_sucursal")

  @@index([id_rol], name: "fk_usuario_rol_id")
  @@index([id_sucursal], name: "fk_usuario_sucursal_id")
}



// Tablas del modulo Facturacion

model CatalogoCategorias {
  id_categoria Int                    @id @default(autoincrement())
  nombre       String
  estado       Estado                 @default(ACTIVO)
  catalogo Catalogo[]
}

model CatalogoTipo {
  id_tipo   Int                    @id @default(autoincrement())
  nombre    String
  estado    Estado                 @default(ACTIVO)
  catalogo Catalogo[]
}

model Catalogo {
  id_catalogo  Int     @id @default(autoincrement())
  id_tipo      Int
  id_categoria Int
  codigo       String? @db.Text
  nombre       String
  descripcion  String? @db.Text 
  precio       Float?  @default(0) 
  Tipo CatalogoTipo @relation(fields: [id_tipo], references: [id_tipo], onDelete: NoAction, onUpdate: NoAction, map: "fk_tipo_catalogo")
  Categorias CatalogoCategorias @relation(fields: [id_categoria], references: [id_categoria], onDelete: NoAction, onUpdate: NoAction, map: "fk_categoria_sefvicio")
  estado                     Estado                       @default(ACTIVO) 
  fecha_creacion  DateTime               @default(now()) @db.Timestamp()

  @@index([id_tipo], name: "fk_tipo_catalogo_id")
  @@index([id_categoria], name: "fk_categoria_sefvicio_id")
}